<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesión Personal - Mediplus</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script type="module">
        import '/styles/tailwind.css';
    </script>
    <style>
        /* --- Reseteo Básico y Fuentes --- */
        :root {
            --color-primario: #ADBAC7; /* Color gris azulado */
            --color-fondo-imagen: #334;
            --color-texto-claro: #ffffff;
            --color-texto-oscuro: #333;
            --color-borde: #ddd;
            --color-fondo-claro: #f4f7f6;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: var(--color-texto-oscuro);
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden; /* Evitar scroll */
        }

        /* --- 1. Contenedor Principal (Flexbox) --- */
        .login-container {
            display: flex;
            width: 100%;
            height: 100vh; /* Altura completa de la pantalla */
            background: var(--color-texto-claro);
            overflow: hidden; /* Ocultar el fondo blanco que se sale */
        }

        /* --- 2. Columna Izquierda (Imagen) --- */
        .login-image-section {
            flex-basis: 55%; /* La columna de imagen ocupa el 55% */
            position: relative;
            color: var(--color-texto-oscuro); /* Cambiar a texto oscuro para mejor contraste */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 40px;
            overflow: visible; /* Permitir que la imagen de doctores se salga */
            
            /* Imagen de fondo */
            background-image: url('/ini_se.jpg');
            background-size: 180% auto; /* Aumentar mucho más el tamaño */
            background-position: -300px -50px; /* Mover mucho más a la izquierda y arriba */
            background-repeat: no-repeat;
        }
        
        /* Capa sutil sobre la imagen para mejor legibilidad */
        .login-image-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.15); /* Overlay claro y sutil */
            z-index: 1;
        }

        /* Imagen de doctores superpuesta */
        .doctores-image {
            position: absolute;
            bottom: 0;
            right: -30px; /* Un poco más a la derecha */
            width: auto;
            height: 85%;
            max-height: 650px;
            object-fit: contain;
            z-index: 2;
            pointer-events: none;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        /* Posicionamos el contenido por encima del overlay */
        .login-image-section > *:not(.doctores-image) {
            position: relative;
            z-index: 3;
        }

        .logo {
            font-family: 'Nunito Sans', sans-serif;
            font-size: 3.5rem; /* Más grande */
            font-weight: 700; /* Bold */
            color: #ffffff; /* Color blanco */
            text-align: center; /* Centrado */
            width: 100%; /* Ocupar todo el ancho para centrar */
        }

        .info-box {
            background-color: rgba(255, 255, 255, 0.1); /* Fondo transparente */
            padding: 15px 20px;
            border-radius: 10px;
            backdrop-filter: blur(15px); /* Efecto blur más pronunciado */
            -webkit-backdrop-filter: blur(15px); /* Soporte para Safari */
            border: 1px solid rgba(255, 255, 255, 0.3);
            max-width: 300px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Sombra sutil */
            color: #ffffff; /* Texto blanco para mejor contraste */
        }
        
        /* Primer recuadro (Médicos Calificados) más arriba */
        .info-box:not(.bottom-info-box) {
            margin-top: -320px; /* Bajarlo un poco */
            max-width: 240px; /* Hacerlo un poco más pequeño pero rectangular */
            padding: 10px 14px; /* Reducir el padding */
        }
        
        .info-box:not(.bottom-info-box) h3 {
            font-size: 1.1rem; /* Título un poco más grande */
        }
        
        .info-box:not(.bottom-info-box) p {
            font-size: 0.75rem; /* Texto más pequeño */
        }
        
        .info-box h3 {
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: #ffffff; /* Color blanco */
        }
        
        .info-box p {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.9); /* Blanco con ligera transparencia */
        }
        
        /* El "Book an appointment" está al final */
        .bottom-info-box {
            align-self: center; /* Centrado */
        }


        /* --- 3. Columna Derecha (Formulario) --- */
        .login-form-section {
            flex-basis: 45%; /* La columna de formulario ocupa el 45% */
            padding: 50px 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .login-form-section h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .login-form-section .subtitle {
            font-size: 1rem;
            color: #777;
            margin-bottom: 30px;
        }
        
        .login-form-section .subtitle a {
            color: var(--color-primario);
            text-decoration: none;
            font-weight: 600;
        }

        /* --- 4. Formulario y Campos --- */
        .input-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        .input-group label {
            display: block;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px 15px;
            font-size: 1rem;
            border: 1px solid var(--color-borde);
            border-radius: 8px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: var(--color-primario);
            box-shadow: 0 0 0 3px rgba(173, 186, 199, 0.2);
        }

        /* Wrapper para el ícono del ojo */
        .password-wrapper {
            position: relative;
        }

        .password-wrapper .eye-icon {
            position: absolute;
            top: 70%; /* Ajustado para alinear con el input, no el label */
            right: 15px;
            transform: translateY(-50%);
            cursor: pointer;
            opacity: 0.5;
            /* Usamos una imagen SVG en línea como ícono de ojo */
            content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z'%3E%3C/path%3E%3Ccircle cx='12' cy='12' r='3'%3E%3C/circle%3E%3C/svg%3E");
        }

        .options-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        .options-row .remember-me {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .options-row a {
            color: var(--color-primario);
            text-decoration: none;
        }

        .login-button {
            width: 100%;
            padding: 14px;
            font-size: 1rem;
            font-weight: 600;
            color: var(--color-texto-claro);
            background-color: var(--color-primario);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .login-button:hover {
            background-color: #8fa5b8;
        }

        /* --- 5. Divisor y Logins Sociales --- */
        .divider {
            display: flex;
            align-items: center;
            text-align: center;
            color: #aaa;
            margin: 30px 0;
        }
        
        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid var(--color-borde);
        }
        
        .divider:not(:empty)::before {
            margin-right: 1em;
        }
        
        .divider:not(:empty)::after {
            margin-left: 1em;
        }

        .social-login {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        .social-button {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 44px;
            height: 44px;
            border: 1px solid var(--color-borde);
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .social-button:hover {
            background-color: #f9f9f9;
        }
        
        .social-button img {
            width: 24px;
            height: 24px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .login-container {
                flex-direction: column;
                min-height: auto;
            }
            
            .login-image-section {
                flex-basis: 40%;
                min-height: 300px;
            }
            
            .login-form-section {
                flex-basis: 60%;
                padding: 30px 40px;
            }
        }

    </style>
</head>
<body>

    <div class="login-container">
        
        <div class="login-image-section">
            <img src="/doctores_fondo.png" alt="Doctores" class="doctores-image">
            
            <div class="logo">
                <div style="display: flex; align-items: center; justify-content: center; gap: 4px;">
                    <img src="/Medi_logo.png" alt="Mediplus Logo" style="width: 90px; height: 90px; filter: brightness(0) invert(1); margin-left: 20px;">
                    <span>ediplus</span>
                </div>
            </div>
            
            <div class="info-box">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <img src="/orejas.png" alt="Logo" style="width: 60px; height: 60px; filter: brightness(0);">
                    <h3 style="margin: 0;">Médicos Calificados</h3>
                </div>
                <p>Tratamiento con el mayor cuidado</p>
            </div>
            
            <div class="info-box bottom-info-box">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                    <img src="/calendar_logo.png" alt="Logo" style="width: 40px; height: 40px; filter: brightness(0);">
                    <h3 style="margin: 0;">Agenda una cita</h3>
                </div>
                <p>Llamada/Web/Presencial</p>
            </div>
        </div>
        
        <div class="login-form-section">
            <h1>Bienvenido de nuevo</h1>
            <p class="subtitle">
                ¿Nuevo en el personal? <a href="/pages/auth/register-personal.html">Regístrate</a>
            </p>
            <p class="subtitle" style="margin-top: 10px;">
                ¿Eres paciente? <a href="/pages/auth/login.html">Inicia sesión aquí</a>
            </p>
            
            <form id="loginForm">
                <div class="input-group">
                    <label for="email">Correo Electrónico</label>
                    <input type="email" id="email" name="email" placeholder="usuario@mediplus.com" required>
                </div>
                
                <div class="input-group password-wrapper">
                    <label for="password">Tu contraseña</label>
                    <input type="password" id="password" name="password" placeholder="••••••••" required>
                    <span class="eye-icon"></span>
                </div>
                
                <div class="options-row">
                    <div class="remember-me">
                        <input type="checkbox" id="remember">
                        <label for="remember" style="font-weight: normal; margin-bottom: 0;">Recordarme</label>
                    </div>
                    <a href="#">¿Olvidaste tu contraseña?</a>
                </div>
                
                <button type="submit" class="login-button">Iniciar Sesión</button>
            </form>
            
            <div class="divider">O inicia sesión con</div>
            
            <div class="social-login">
                <button class="social-button" aria-label="Iniciar sesión con Google">
                    <img src="/google_logo.png" alt="Google">
                </button>
                <button class="social-button" aria-label="Iniciar sesión con Facebook">
                    <img src="/facebook_logo.png" alt="Facebook">
                </button>
                <button class="social-button" aria-label="Iniciar sesión con Apple">
                    <img src="/apple_logo.png" alt="Apple">
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // Función para obtener usuarios registrados
        function getRegisteredUsers() {
            const users = localStorage.getItem('registeredUsers');
            return users ? JSON.parse(users) : [];
        }

        // Función para buscar usuario por email y password
        function findUser(email, password) {
            const users = getRegisteredUsers();
            return users.find(user => user.email === email && user.password === password);
        }

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // Buscar usuario en los registrados
            const user = findUser(email, password);
            
            if (user) {
                // Verificar que el usuario NO sea un paciente
                if (user.role === 'paciente') {
                    alert('Este login es solo para personal. Si eres paciente, usa el login de pacientes.');
                    return;
                }
                
                // Usuario encontrado, guardar información y redirigir
                localStorage.setItem('userRole', user.role);
                localStorage.setItem('userEmail', user.email);
                localStorage.setItem('userName', user.name);
                localStorage.setItem('isLoggedIn', 'true');
                
                // Redirigir según el rol
                const roleMap = {
                    'admin': '/pages/roles/admin/dashboard.html',
                    'medico': '/pages/roles/medico/agenda.html',
                    'enfermeria': '/pages/roles/enfermeria/sala-espera.html',
                    'admision': '/pages/roles/admision/citas.html',
                    'caja': '/pages/roles/caja/facturacion.html'
                };
                
                const redirectUrl = roleMap[user.role] || '/pages/roles/admin/dashboard.html';
                window.location.href = redirectUrl;
            } else {
                alert('Credenciales incorrectas. Por favor, regístrate primero.');
            }
        });
    </script>
</body>
</html>

